("function"==typeof define&&define.amd?define:function(e,t){return t()})(["./kendo.calendar.min","./kendo.popup.min"],function(){(function(e,t){function a(t){var a=t.parseFormats;O.normalize(t),a=e.isArray(a)?a:[a],a.splice(0,0,t.format),t.parseFormats=a}function n(e){e.preventDefault()}var o,i=window.kendo,r=i.ui,s=r.Widget,l=i.parseDate,d=i.keys,u=i.template,p="<div />",c="<span />",f=".kendoDatePicker",m="click"+f,v="open",h="close",_="change",k="dateView",w="disabled",g="k-state-default",y="k-state-focused",b="k-state-selected",C="k-state-disabled",V="k-state-hover",x="keydown"+f,D="mouseenter"+f+" mouseleave"+f,T="mousedown"+f,A="id",I="min",W="max",R="month",E="aria-disabled",N="aria-expanded",F="aria-hidden",O=i.calendar,P=O.isInRange,S=O.restrictValue,H=O.isEqualDatePart,B=e.extend,z=e.proxy,K=Date,U=function(t){var a,n=this,s=document.body,l=o.sharedCalendar,d=e(p).attr(F,"true").addClass("k-calendar-container").appendTo(s);l||(l=o.sharedCalendar=new r.Calendar(e(p).attr(A,i.guid()).hide().appendTo(s),{focusOnNav:!1}),O.makeUnselectable(l.element)),n.calendar=l,n.options=t=t||{},a=t.id,a&&(a+="_dateview",d.attr(A,a),n._dateViewID=a),n.popup=new r.Popup(d,B(t.popup,t,{name:"Popup",isRtl:i.support.isRtl(t.anchor)})),n.div=d,n._templates(),n.value(t.value)};U.prototype={_calendar:function(){var e=this,t=e.popup,a=e.options,o=e.calendar,i=o.element;i.data(k)!==e&&(i.appendTo(t.element).data(k,e).off(m+" "+x).on(m,"td:has(.k-link)",z(e._click,e)).on(T,n).show(),o.unbind(_).bind(_,a),o.month=e.month,o.options.dates=a.dates,o.options.depth=a.depth,o.options.culture=a.culture,o._footer(e.footer),o.min(a.min),o.max(a.max),o.navigate(e._value,a.start),e.value(e._value))},destroy:function(){var a,n=this,i=n.calendar,r=i.element,s=r.data(k);(s===t||s===n)&&(a=e(".k-calendar-container"),a.length>1?r.hide().appendTo(document.body):(r.off(f),i.destroy(),o.sharedCalendar=null)),n.popup.destroy()},open:function(){var e=this;e._calendar(),e.popup.open()},close:function(){this.popup.close()},min:function(e){this._option(I,e)},max:function(e){this._option(W,e)},toggle:function(){var e=this;e[e.popup.visible()?h:v]()},move:function(e){var a=this,n=e.keyCode,o=a.calendar,i=e.ctrlKey&&n==d.DOWN||n==d.ENTER;if(n==d.ESC)return a.close(),t;if(e.altKey)return n==d.DOWN?(a.open(),e.preventDefault()):n==d.UP&&(a.close(),e.preventDefault()),t;if(a.popup.visible())return i&&o._cell.hasClass(b)?(a.close(),e.preventDefault(),t):(a._current=o._move(e),t)},value:function(e){var t=this,a=t.calendar,n=t.options;t._value=e,t._current=new K(+S(e,n.min,n.max)),a.element.data(k)===t&&a.value(e)},_click:function(e){-1!==e.currentTarget.className.indexOf(b)&&this.close()},_option:function(e,t){var a=this,n=a.options,o=a.calendar;n[e]=t,o.element.data(k)===a&&o[e](t)},_templates:function(){var e=this,t=e.options,a=t.footer,n=t.month||{},o=n.content,r=n.empty;e.month={content:u('<td#=data.cssClass#><a tabindex="-1" class="k-link" href="\\#" '+i.attr("value")+'="#=data.dateString#" title="#=data.title#">'+(o||"#=data.value#")+"</a></td>",{useWithBlock:!!o}),empty:u("<td>"+(r||"&nbsp;")+"</td>",{useWithBlock:!!r})},a!==!1&&(e.footer=u(a||'#= kendo.toString(data,"D","'+t.culture+'") #',{useWithBlock:!1}))}},U.normalize=a,i.DateView=U,o=s.extend({init:function(e,t){var n,o=this;s.fn.init.call(o,e,t),e=o.element,t=o.options,a(t),o._wrapper(),o.dateView=new U(B({},t,{id:e.attr(A),anchor:o.wrapper,change:function(){o._change(this.value()),o.close()},close:function(t){o.trigger(h)?t.preventDefault():(e.attr(N,!1),n.attr(F,!0))},open:function(t){var a,i=o.options;o.trigger(v)?t.preventDefault():(a=l(e.val(),i.parseFormats,i.culture),a?(o.dateView._current=a,o.dateView.calendar._focus(a)):o.dateView.value(a),e.attr(N,!0),n.attr(F,!1))}})),n=o.dateView.div,o._icon(),e[0].type="text",e.addClass("k-input").on("keydown"+f,z(o._keydown,o)).on("blur"+f,z(o._blur,o)).on("focus"+f,function(){o._inputWrapper.addClass(y)}).attr({role:"textbox","aria-haspopup":!0,"aria-expanded":!1,"aria-owns":o.dateView._dateViewID}),o._reset(),o._template(),o.enable(!e.is("[disabled]")),o.value(t.value||o.element.val()),i.notify(o)},events:[v,h,_],options:{name:"DatePicker",value:null,footer:"",format:"",culture:"",parseFormats:[],min:new Date(1900,0,1),max:new Date(2099,11,31),start:R,depth:R,animation:{},month:{},dates:[],ARIATemplate:'Current focused date is #=kendo.toString(data.current, "D")#'},setOptions:function(e){var t=this,n=t.dateView,o=n.options;s.fn.setOptions.call(t,e),a(t.options),n.options=B(o,t.options,{change:o.change,close:o.close,open:o.open})},enable:function(e){var t=this,a=t._dateIcon.off(f),o=t._inputWrapper.off(f),i=t.element;e===!1?(o.removeClass(g).addClass(C),i.attr(w,w).attr(E,!0)):(o.addClass(g).removeClass(C).on(D,t._toggleHover),i.removeAttr(w).attr(E,!1),a.on(m,z(t._click,t)).on(T,n))},destroy:function(){var e=this;s.fn.destroy.call(e),e.dateView.destroy(),e.element.off(f),e._dateIcon.off(f),e._inputWrapper.off(f),e._form&&e._form.off("reset",e._resetHandler)},open:function(){this.dateView.open()},close:function(){this.dateView.close()},min:function(e){return this._option(I,e)},max:function(e){return this._option(W,e)},value:function(e){var a=this;return e===t?a._value:(a._old=a._update(e),null===a._old&&a.element.val(""),t)},_toggleHover:function(t){e(t.currentTarget).toggleClass(V,"mouseenter"===t.type)},_blur:function(){var e=this;e.close(),e._change(e.element.val()),e._inputWrapper.removeClass(y)},_click:function(e){var t=this,a=t.element;t.dateView.toggle(),"click"===e.type&&a[0]!==document.activeElement&&a.focus()},_change:function(e){var t=this;e=t._update(e),+t._old!=+e&&(t._old=e,t.trigger(_),t.element.trigger(_))},_keydown:function(e){var t=this,a=t.dateView;a.popup.visible()||e.keyCode!=d.ENTER?(a.move(e),t._updateARIA(a._current)):t._change(t.element.val())},_icon:function(){var t,a=this,n=a.element;t=n.next("span.k-select"),t[0]||(t=e('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span></span>').insertAfter(n)),a._dateIcon=t.attr({role:"button","aria-controls":a.dateView._dateViewID})},_option:function(e,a){var n=this,o=n.options;return a===t?o[e]:(a=l(a,o.parseFormats,o.culture),a&&(o[e]=new K(+a),n.dateView[e](a)),t)},_update:function(e){var t,a=this,n=a.options,o=n.min,r=n.max,s=l(e,n.parseFormats,n.culture);return+s===+a._value?(t=i.toString(s,n.format,n.culture),t!==e&&a.element.val(null===s?e:t),s):(null!==s&&H(s,o)?s=S(s,o,r):P(s,o,r)||(s=null),a._value=s,a.dateView.value(s),a.element.val(s?i.toString(s,n.format,n.culture):e),a._updateARIA(s),s)},_wrapper:function(){var t,a=this,n=a.element;t=n.parents(".k-datepicker"),t[0]||(t=n.wrap(c).parent().addClass("k-picker-wrap k-state-default"),t=t.wrap(c).parent()),t[0].style.cssText=n[0].style.cssText,n.css({width:"100%",height:n[0].style.height}),a.wrapper=t.addClass("k-widget k-datepicker k-header").addClass(n[0].className),a._inputWrapper=e(t[0].firstChild)},_reset:function(){var e=this,t=e.element,a=t.closest("form");a[0]&&(e._resetHandler=function(){e.value(t[0].defaultValue)},e._form=a.on("reset",e._resetHandler))},_template:function(){this._ariaTemplate=u(this.options.ARIATemplate)},_updateARIA:function(e){this.element.attr("aria-label",this._ariaTemplate({current:e}))}}),r.plugin(o)})(window.kendo.jQuery)});