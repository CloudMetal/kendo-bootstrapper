("function"==typeof define&&define.amd?define:function(t,e){return e()})(["./kendo.scheduler.view.min"],function(){!function(t){function e(){return i.culture().calendars.standard}function n(t){for(var n=e(),a=n.firstDay,s=new Date(t.getFullYear(),t.getMonth(),0,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());s.getDay()!=a;)i.date.setTime(s,-1*h);return s}function a(t,e,n){var a,i=e.getTime(),s=n.getTime();return a=t.getTime(),a>=i&&s>=a}var i=window.kendo,s=i.ui,o=s.SchedulerView,r=".kendoMonthView",d=t.extend,l=t.proxy,c=i.date.getDate,h=i.date.MS_PER_DAY,u=i.template('<span class="k-link k-nav-day">#=kendo.toString(date, "dd")#</span>'),f='<div class="k-event" data-#=ns#uid="#=uid#"#if (resources[0]) { #style="background-color:#=resources[0].color #"#}#><span class="k-event-actions"># if(data.tail || data.middle) {#<span class="k-icon k-i-arrow-w"></span>#}## if(data.recurrence || data.recurrenceId) {#<a href="\\#" class="k-link"><span class="k-icon k-i-refresh"></span></a>#}#</span>{0}<span class="k-event-actions">#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-i-close"></span></a>#}## if(data.head || data.middle) {#<span class="k-icon k-i-arrow-e"></span>#}#</span></div>',v=i.template('<div title="#=title#"><dl><dd>${title}</dd></dl></div>');s.MonthView=o.extend({init:function(t,e){var n=this;o.fn.init.call(n,t,e),n.title=n.name=n.options.title,n.eventTemplate=n._eventTmpl(n.options.eventTemplate),n._editable(),n._renderLayout(n.options.date)},dateForTitle:function(){return i.format(this.options.selectedDateFormat,this._firstDayOfMonth,this._lastDayOfMonth)},nextDate:function(){return i.date.nextDay(this._lastDayOfMonth)},previousDate:function(){return i.date.previousDay(this._firstDayOfMonth)},startDate:function(){return this._startDate},endDate:function(){return this._endDate},_renderLayout:function(e){var a=this;this._firstDayOfMonth=i.date.firstDayOfMonth(e),this._lastDayOfMonth=i.date.lastDayOfMonth(e),this._startDate=n(e),this.createLayout(this._layout()),this.table.addClass("k-scheduler-monthview"),this._content(),this.refreshLayout(),this.content.on("click"+r,".k-nav-day",function(e){var n=t(e.currentTarget).closest("td");a.trigger("navigate",{view:"day",date:a._rangeToDates(n).start})}),this.content.on("click"+r,".k-more-events",function(e){var n=o.rangeIndex(t(e.currentTarget)).start,s=i.date.addDays(a.startDate(),n);a.trigger("navigate",{view:"day",date:s})})},_editable:function(){var e=this;e.options.editable&&(e.element.on("click"+r,".k-scheduler-monthview .k-event a:has(.k-i-close)",function(n){e.trigger("remove",{uid:t(this).closest(".k-event").attr(i.attr("uid"))}),n.preventDefault()}),e.options.editable.create!==!1&&e.element.on("dblclick"+r,".k-scheduler-monthview .k-scheduler-content td",function(n){var a=t(this);e.trigger("add",{eventInfo:d({isAllDay:!0},e._rangeToDates(a))}),n.preventDefault()}),e.options.editable.update!==!1&&e.element.on("dblclick"+r,".k-scheduler-monthview .k-event",function(n){e.trigger("edit",{uid:t(this).closest(".k-event").attr(i.attr("uid"))}),n.preventDefault()}))},_rangeToDates:function(t){var e=this.content.find("table td").index(t),n=i.date.addDays(this.startDate(),e);return n?{start:n,end:new Date(n)}:null},_content:function(){for(var t=this.startDate(),e=this._firstDayOfMonth,n=this._lastDayOfMonth,a=0,s=42,o=7,r=this.options.dayTemplate,d="",l={},h=[t],u="<tbody><tr>";s>a;a++)a>0&&0===a%o&&(h.push(t),u+="</tr><tr>"),d="",i.date.isToday(t)&&(d+="k-today"),i.date.isInDateRange(t,e,n)||(d+=" k-other-month"),u+="<td ",""!==d&&(u+='class="'+d+'"'),u+=">",u+=r({date:t}),u+="</td>",l[c(t).getTime()]=a,t=i.date.nextDay(t);u+="</tr></tbody>",this._slotIndices=l,this._weekStartDates=h,this._endDate=i.date.previousDay(t),this.content.find("table").html(u)},_layout:function(){var n=e().days.names;return{columns:t.map(n,function(t){return{text:t}})}},_eventTmpl:function(t){var e,n=this.options,a=d({},i.Template,n.templateSettings),s=a.paramName,o="",r=typeof t,c={storage:{},count:0};return"function"===r?(c.storage["tmpl"+c.count]=t,o+="#=this.tmpl"+c.count+"("+s+")#",c.count++):"string"===r&&(o+=t),e=i.template(i.format(f,o),a),c.count>0&&(e=l(e,c.storage)),e},_createEventElement:function(e,n){var a=this.options,s=a.editable&&a.editable.destroy!==!1;return t(n(d({},{ns:i.ns,showDelete:s,resources:this.eventResources(e)},e)))},_isInDateSlot:function(t){var e=this.startDate(),n=new Date(this.endDate().getTime()+h-1);return a(t.start,e,n)||a(t.end,e,n)||a(e,t.start,t.end)||a(n,t.start,t.end)},_slotIndex:function(t){return this._slotIndices[c(t).getTime()]},_calculateAllDayEventWidth:function(t,e){var n,a,i=this.content.find("table td"),s=0,o=t!==e?"outerWidth":"innerWidth";for(n=0,a=i.length;a>n;n++)n>=t&&e>=n&&(s+=i.eq(n)[o]());return s},_positionEvent:function(e,n,a){var s,r,d,l,c,h,u,f,v,m,p,g,D,k,y,_,T;for(0>n&&(n=0),(0>a||!a)&&(a=this.content.find("td").length-1),r=this.content.find("td").eq(n),d=r.children().first(),l=o.collidingEvents(this.content.find(".k-event"),n,a).add(e),c=this.options.eventHeight,h=2,u=n!==a?5:4,f=this._calculateAllDayEventWidth(n,a)-u,v=(d.length?d.outerHeight():0)+3,m=Math.floor((r.height()-v)/(c+3)),p=r.position().top+v+this.content[0].scrollTop,g=r.position().left+h,e.css({width:f,left:g,height:c}),e.attr(i.attr("start-end-idx"),n+"-"+a),s=o.createColumns(l,!0),D=0,k=Math.min(s.length,m);k>D;D++)for(y=s[D].events,_=0,T=y.length;T>_;_++)t(y[_]).css({top:p+D*c+3*D});s.length>m&&(this.content.find(i.format(".k-more-events[{0}={1}-{2}]",i.attr("start-end-idx"),n,a)).remove(),e=t('<div class="k-more-events k-button"><span>...</span></div>').attr(i.attr("start-end-idx"),n+"-"+a).css({width:f+2,left:g,top:p+m*c+3*m})),e.appendTo(this.content)},_splitEvents:function(t){var e,n,s,o,r,l,u,f,v=[],m=this._weekStartDates;for(e=0,r=t.length;r>e;e++){for(n=d({},t[e]),l=0,u=m.length;u>l;l++)o=m[l],s=Math.ceil((n.end-n.start)/h),a(o,n.start,n.end)&&s>=1&&(c(n.start).getTime()===c(o).getTime()?n.tail?(n.tail=!1,n.middle=!0):n.head=!0:(f=d({},n),n.tail?(n.tail=!1,f.middle=!0):f.head=!0,f.start=n.start,f.end=i.date.previousDay(o),v.push(f),n.start=o,n.head=!1,c(n.end).getTime()>c(this.endDate()).getTime()+h-1?n.middle=!0:n.tail=!0,n.end=n.end));v.push(n)}return v},render:function(t){var e,n,a,s,o,r,d=this.eventTemplate;for(this.content.find(".k-event, .k-more-events").remove(),t=new i.data.Query(this._splitEvents(t)).sort([{field:"start",dir:"asc"},{field:"end",dir:"desc"}]).toArray(),n=0,a=t.length;a>n;n++)e=t[n],this._isInDateSlot(e)&&(s=this._slotIndex(e.start),o=this._slotIndex(e.end),r=this._createEventElement(e,d),-1===s&&o>-1&&(s=o),this._positionEvent(r,s,o))},destroy:function(){this.table&&this.table.removeClass("k-scheduler-monthview"),this.content&&this.content.off(r),this.element&&this.element.off(r),o.fn.destroy.call(this)},events:["remove","add","edit","navigate"],options:{title:"Month",name:"month",eventHeight:25,editable:!0,selectedDateFormat:"{0:y}",dayTemplate:u,eventTemplate:v}})}(window.kendo.jQuery)});